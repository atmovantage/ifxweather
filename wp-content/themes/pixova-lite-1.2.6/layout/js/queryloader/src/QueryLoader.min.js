function QueryLoader(a,b){"use strict";this.element=a,this.options=b,this.done=!1,this.maxTimeout=null,this.defaultOptions={onComplete:function(){},onProgress:function(){},backgroundColor:"#000",barColor:"#fff",overlayId:"qLoverlay",percentageId:"qLpercentage",barHeight:1,percentage:!1,deepSearch:!0,minimumTime:300,maxTime:1e4,fadeOutTime:1e3},this.overlay=null,this.preloader=null,null!==a&&this.init()}function QueryLoader(a,b){"use strict";this.element=a,this.options=b,this.done=!1,this.maxTimeout=null,this.defaultOptions={onComplete:function(){},onProgress:function(){},backgroundColor:"#000",barColor:"#fff",overlayId:"qLoverlay",percentageId:"qLpercentage",barHeight:1,percentage:!1,deepSearch:!0,minimumTime:300,maxTime:1e4,fadeOutTime:1e3},this.overlay=null,this.preloader=null,null!==a&&this.init()}var ImagePreloader=require("./ImagePreloader/"),Overlay=require("./Overlay/");QueryLoader.prototype.init=function(){"use strict";this.options=this.extend(this.defaultOptions,this.options),"undefined"!=typeof this.element&&(this.createOverlay(),this.removeTempOverlay(),this.createPreloader(),this.startMaxTimeout())},QueryLoader.prototype.extend=function(a,b){"use strict";"undefined"==typeof a&&(a={});for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},QueryLoader.prototype.startMaxTimeout=function(){"use strict";this.maxTimeout=window.setTimeout(this.doneLoading.bind(this),this.options.maxTime)},QueryLoader.prototype.createOverlay=function(){"use strict";this.overlay=new Overlay(this.element),this.overlay.idName=this.options.overlayId,this.overlay.percentageId=this.options.percentageId,this.overlay.backgroundColor=this.options.backgroundColor,this.overlay.barHeight=this.options.barHeight,this.overlay.barColor=this.options.barColor,this.overlay.showPercentage=this.options.percentage,this.overlay.fadeOutTime=this.options.fadeOutTime,"undefined"!=typeof this.element&&this.overlay.init()},QueryLoader.prototype.removeTempOverlay=function(){window.setTimeout(function(){var a=document.getElementById("qLtempOverlay");a&&a.parentNode.removeChild(a)},0)},QueryLoader.createTempOverlay=function(){var a=window.setInterval(function(){if("undefined"!=typeof document.getElementsByTagName("body")[0]){var b=document.createElement("div");b.style.position="fixed",b.style.width="100%",b.style.height="100%",b.style.zIndex="9999",b.style.backgroundColor="#000",b.style.left="0",b.style.top="0",b.setAttribute("id","qLtempOverlay"),document.getElementsByTagName("body")[0].appendChild(b),window.clearInterval(a)}},1)},QueryLoader.prototype.createPreloader=function(){"use strict";this.preloader=new ImagePreloader(this),this.preloader.deepSearch=this.options.deepSearch,window.setTimeout(function(){this.preloader.findAndPreload(this.element)}.bind(this),100)},QueryLoader.prototype.updateProgress=function(a,b){"use strict";var c=a/b*100;this.overlay.updateProgress(c,this.options.minimumTime),"function"==typeof this.options.onProgress&&this.options.onProgress(c,a,b),a===b&&this.done===!1&&(window.clearTimeout(this.maxTimeout),window.setTimeout(this.doneLoading.bind(this),this.options.minimumTime))},QueryLoader.prototype.doneLoading=function(){"use strict";window.clearTimeout(this.maxTimeout),this.done=!0,this.overlay.element.style.opacity=0,window.setTimeout(this.destroy.bind(this),this.options.fadeOutTime)},QueryLoader.prototype.destroy=function(){"use strict";this.overlay.remove(),this.options.onComplete()},module.exports=QueryLoader;var ImagePreloader=require("./ImagePreloader/"),Overlay=require("./Overlay/");QueryLoader.prototype.init=function(){"use strict";this.options=this.extend(this.defaultOptions,this.options),"undefined"!=typeof this.element&&(this.createOverlay(),this.removeTempOverlay(),this.createPreloader(),this.startMaxTimeout())},QueryLoader.prototype.extend=function(a,b){"use strict";"undefined"==typeof a&&(a={});for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},QueryLoader.prototype.startMaxTimeout=function(){"use strict";this.maxTimeout=window.setTimeout(this.doneLoading.bind(this),this.options.maxTime)},QueryLoader.prototype.createOverlay=function(){"use strict";this.overlay=new Overlay(this.element),this.overlay.idName=this.options.overlayId,this.overlay.percentageId=this.options.percentageId,this.overlay.backgroundColor=this.options.backgroundColor,this.overlay.barHeight=this.options.barHeight,this.overlay.barColor=this.options.barColor,this.overlay.showPercentage=this.options.percentage,this.overlay.fadeOutTime=this.options.fadeOutTime,"undefined"!=typeof this.element&&this.overlay.init()},QueryLoader.prototype.removeTempOverlay=function(){window.setTimeout(function(){var a=document.getElementById("qLtempOverlay");a&&a.parentNode.removeChild(a)},0)},QueryLoader.createTempOverlay=function(){var a=window.setInterval(function(){if("undefined"!=typeof document.getElementsByTagName("body")[0]){var b=document.createElement("div");b.style.position="fixed",b.style.width="100%",b.style.height="100%",b.style.zIndex="9999",b.style.backgroundColor="#000",b.style.left="0",b.style.top="0",b.setAttribute("id","qLtempOverlay"),document.getElementsByTagName("body")[0].appendChild(b),window.clearInterval(a)}},1)},QueryLoader.prototype.createPreloader=function(){"use strict";this.preloader=new ImagePreloader(this),this.preloader.deepSearch=this.options.deepSearch,window.setTimeout(function(){this.preloader.findAndPreload(this.element)}.bind(this),100)},QueryLoader.prototype.updateProgress=function(a,b){"use strict";var c=a/b*100;this.overlay.updateProgress(c,this.options.minimumTime),"function"==typeof this.options.onProgress&&this.options.onProgress(c,a,b),a===b&&this.done===!1&&(window.clearTimeout(this.maxTimeout),window.setTimeout(this.doneLoading.bind(this),this.options.minimumTime))},QueryLoader.prototype.doneLoading=function(){"use strict";window.clearTimeout(this.maxTimeout),this.done=!0,this.overlay.element.style.opacity=0,window.setTimeout(this.destroy.bind(this),this.options.fadeOutTime)},QueryLoader.prototype.destroy=function(){"use strict";this.overlay.remove(),this.options.onComplete()},module.exports=QueryLoader;
//# sourceMappingURL=QueryLoader.min.js.map